(this["webpackJsonpall-in-one"]=this["webpackJsonpall-in-one"]||[]).push([[0],{723:function(e,t,n){"use strict";n.r(t);var i=n(5),s=n(6),r=n(722),a=n.n(r),o="[,]",c="[.]",u="choice",d="fill-in",p="matching",l="other",h="http://adlnet.gov/expapi/activities/course",v="http://adlnet.gov/expapi/activities/objective",f="http://adlnet.gov/expapi/activities/cmi.interaction",b="http://easygenerator/expapi/course/id",y="http://easygenerator/expapi/question/survey",m="http://easygenerator/expapi/question/type",x="http://easygenerator/expapi/question/imageUrl",S="http://easygenerator/expapi/question/content",w="http://easygenerator/expapi/question/answers",g={started:{id:"http://adlnet.gov/expapi/verbs/launched",display:{"en-US":"started"}},stopped:{id:"http://adlnet.gov/expapi/verbs/exited",display:{"en-US":"stopped"}},passed:{id:"http://adlnet.gov/expapi/verbs/passed",display:{"en-US":"passed"}},failed:{id:"http://adlnet.gov/expapi/verbs/failed",display:{"en-US":"failed"}},experienced:{id:"http://adlnet.gov/expapi/verbs/experienced",display:{"en-US":"experienced"}},answered:{id:"http://adlnet.gov/expapi/verbs/answered",display:{"en-US":"answered"}},mastered:{id:"http://adlnet.gov/expapi/verbs/mastered",display:{"en-US":"mastered"}},progressed:{id:"http://adlnet.gov/expapi/verbs/progressed",display:{"en-US":"progressed"}},evaluated:{id:"http://www.tincanapi.co.uk/verbs/evaluated",display:{"en-US":"evaluated"}}},j=n(19),O=n(30),E=n(88),k=function(e){return new a.a.Activity({id:Object(E.e)(e.id),definition:new a.a.ActivityDefinition({type:v,name:{"en-US":e.title}})})},A=function(e){var t=e.score,n=e.omitScore,i=void 0!==n&&n,s=e.response;return new a.a.Result(Object(j.a)({},!i&&{score:new a.a.Score({scaled:t/100})},{},s&&{response:s}))},U=new(function(){function e(){Object(i.a)(this,e),this.courseId=void 0,this.sessionId=void 0,this.course=void 0,this.actor=void 0,this.lrs=void 0,this.nps=void 0}return Object(s.a)(e,[{key:"initialize",value:function(e){var t=e.course,n=e.actor;this.courseId=t.id,this.sessionId=t.attemptId,this.course=t,this.actor=n}},{key:"initializeLrs",value:function(e,t){this.lrs=new a.a,this.initializeInstance(this.lrs,this.getLrsRecordStore(e,t))}},{key:"initializeNps",value:function(e){this.nps=new a.a,this.initializeInstance(this.nps,this.getNpsRecordStore(e))}},{key:"initializeInstance",value:function(e,t){var n;e.addRecordStore(t),e.actor=this.getActor(this.actor),e.activity=(n=this.course.title,new a.a.Activity({id:Object(O.e)(),definition:new a.a.ActivityDefinition({type:h,name:{"en-US":n}})})),e.context=this.getDefaultContext()}},{key:"getLrsRecordStore",value:function(e,t){var n=e.lrs.uri;return"default"===e.selectedLrs&&(n="".concat(t,"/xApi")),new a.a.LRS({endpoint:n,version:e.version,username:e.lrs.credentials.username,password:e.lrs.credentials.password,allowFail:!1})}},{key:"getNpsRecordStore",value:function(e){return new a.a.LRS({endpoint:"".concat(e,"/xApi"),username:"",password:"",allowFail:!1})}},{key:"getActor",value:function(e){var t=e.username,n=e.email,i=e.account;return i?new a.a.Agent({name:t,account:i}):new a.a.Agent({name:t,mbox:"mailto:".concat(n)})}},{key:"getDefaultContext",value:function(){return this.extendContext(new a.a.Context({contextActivities:new a.a.ContextActivities({})}))}},{key:"extendContext",value:function(e){return e.extensions=e.extensions||{},e.extensions[b]=this.courseId,e.registration=this.sessionId,e}}]),e}()),R=n(10),P=n(9),C=n(11),H=n(26),N=n(4),T=n.n(N),z=n(188),L=function(){return{verb:g.started}},D=function(e){var t=e.course;return{verb:t.isPassed?g.passed:g.progressed,result:A({score:t.score})}},I=function(e){var t=e.score,n=e.response;return{verb:g.evaluated,result:A({score:t,response:n})}},q=function(e){return{verb:e.isPassed?g.mastered:g.progressed,object:k(e),result:A({score:e.score})}},_=n(33),V=n(74),F=n(22),G=function(e){return{response:e.answers.filter((function(t){return e.response.indexOf(t.id)>=0})).map((function(e){return e.id})).join(o),correctResponsesPattern:e.type===F.j?e.correctAnswerId:e.answers.filter((function(e){return e.isCorrect})).map((function(e){return e.id})).join(o),interactionType:u,extraActivityDefinition:{choices:e.answers.map((function(t){return{id:t.id,description:{"en-US":e.type===F.j?t.image:t.text}}}))}}},J=function(e,t){return{response:Object.keys(e.response.data).map((function(t){return"".concat(e.response.data[t]).concat(c).concat(t)})).join(o),correctResponsesPattern:e.answerGroups.map((function(e){var t=e.answers.find((function(e){return e.isCorrect}));return"".concat(t.text).concat(c).concat(e.id)})).join(o),interactionType:d,extensions:Object(_.a)({},S,t[0].value)}},Q=function(e){return{response:e.response.answeredText,omitScore:!0,interactionType:l}},M=function(e){return{response:e.response.map((function(e){return"".concat(e.id).concat(c).concat(e.isCorrect)})).join(o),correctResponsesPattern:e.answers.map((function(e){return"".concat(e.id).concat(c).concat(e.isCorrect)})).join(o),interactionType:u,extraActivityDefinition:{choices:e.answers.map((function(e){return{id:e.id,description:{"en-US":e.text}}}))}}},W=function(e){return{response:e.response.map((function(e){return e.text})).join(o),correctResponsesPattern:e.answers.map((function(e){return e.text})).join(o),interactionType:u,extraActivityDefinition:{choices:e.answers.map((function(e){return{id:e.text,description:{"en-US":e.text}}}))}}},X=function(e){var t=function(e){return e.map((function(e,t){return{id:t.toString(),description:{"en-US":e}}}))},n=e.answers.map((function(e){return e.key})),i=e.answers.map((function(e){return e.value})).filter((function(e,t,n){return n.indexOf(e)===t})),s=e.answers.map((function(e){return"".concat(n.indexOf(e.key)).concat(c).concat(i.indexOf(e.value))})).join(o);return{response:n.map((function(t,n){var s=e.response.find((function(e){return e.key===t})),r="";return s&&s.shownSelectedValue&&(r=i.indexOf(s.shownSelectedValue)),"".concat(n).concat(c).concat(r)})).join(o),correctResponsesPattern:s,interactionType:p,extraActivityDefinition:{source:t(n),target:t(i)}}},B=function(){return{interactionType:l}},K=function(e){var t,n=e.dropspots.map((function(e){return e.text})).join(o),i=e.dropspots.map((function(e){return"(".concat(e.x,",").concat(e.y,")")})).join(o);return{response:e.dropspots.map((function(t){var n=e.response.find((function(e){return e.id===t.id}));if(!n)return"(-1,-1)";var i=n.items.length&&n.items[0];if(!i)return"(-1,-1)";var s=e.dropspots.find((function(e){return e.id===i.id}));return"(".concat(s.x,",").concat(s.y,")")})).join(o),correctResponsesPattern:i,interactionType:l,extensions:(t={},Object(_.a)(t,x,e.background),Object(_.a)(t,w,n),t)}},Y=function(e){return{response:e.response.map((function(e){return"(".concat(e.x,",").concat(e.y,")")})).join(o),correctResponsesPattern:e.spots.map((function(e){return e.map((function(e){return"(".concat(e.x,",").concat(e.y,")")})).join(c)})).join(o),interactionType:l,extensions:Object(_.a)({},x,e.background)}},Z=function(e){var t=Object(V.a)(e,3),n=t[0],i=t[1],s=t[2];return $(n,i,function(e){switch(e.type){case F.i:case F.e:case F.j:return G;case F.b:return J;case F.f:return Q;case F.k:return M;case F.g:return W;case F.l:return X;case F.h:return B;case F.a:return K;case F.c:return Y;default:throw new Error("Question type ".concat(e.type," is not supported"))}}(n)(n,s))};function $(e,t,n){var i=n.response,s=n.correctResponsesPattern,r=n.interactionType,o=n.extraActivityDefinition,c=n.omitScore,u=n.extensions,d=n.verb,p=function(e,t){var n;return U.extendContext(new a.a.Context({contextActivities:new a.a.ContextActivities({parent:[k(t)]}),extensions:(n={},Object(_.a)(n,y,e.hasOwnProperty("isSurvey")&&e.isSurvey),Object(_.a)(n,m,e.type),n)}))}(e,t);p.extensions=Object.assign(p.extensions,u);var l=Object(j.a)({name:{"en-US":e.title},type:f,interactionType:r},s&&{correctResponsesPattern:e.isSurvey?[]:[s]});return l=Object.assign(l,o),{context:p,verb:d||g.answered,object:new a.a.Activity({id:Object(E.c)(t.id,e.id),definition:new a.a.ActivityDefinition(l)}),result:A({score:e.score,omitScore:c,response:i})}}var ee=function(e){var t=Object(V.a)(e,2);return $(t[0],t[1],{interactionType:l,verb:g.experienced})},te=new function e(){var t=this;Object(i.a)(this,e),this.courseStarted=void 0,this.courseProgressed=void 0,this.courseEvaluated=void 0,this.sectionProgressed=void 0,this.questionAnswered=void 0,this.informationContentExperienced=void 0,this.listStatement=void 0,this.listStatement=[{name:"courseStarted",instance:L},{name:"courseProgressed",instance:D},{name:"courseEvaluated",instance:I},{name:"sectionProgressed",instance:q},{name:"questionAnswered",instance:Z},{name:"informationContentExperienced",instance:ee}],this.listStatement.forEach((function(e){t[e.name]=function(){return new a.a.Statement(e.instance.apply(e,arguments))}}))},ne=function(e){console.error("xApi error: [ ".concat(ie(e)," ]"))};function ie(e){return e?e.code&&e.mesg?"code: ".concat(e.code,", message: ").concat(e.mesg):e.toString():"undefined error"}var se=function(e){function t(e){var n,s=e.sendStatement,r=e.shouldHandlerErrors;return Object(i.a)(this,t),(n=Object(R.a)(this,Object(P.a)(t).call(this))).handlers=void 0,n.sendStatement=void 0,n.shouldHandlerErrors=void 0,n.handlers=[],n.sendStatement=s,n.shouldHandlerErrors=r,n}return Object(C.a)(t,e),Object(s.a)(t,[{key:"createHandler",value:function(e){var t=this;return function(n){return T.a.async((function(i){for(;;)switch(i.prev=i.next){case 0:return i.next=2,T.a.awrap(t.handle(e,n));case 2:case"end":return i.stop()}}))}}},{key:"handle",value:function(e,t){var n;return T.a.async((function(i){for(;;)switch(i.prev=i.next){case 0:return i.prev=0,n=te[e](t),i.next=4,T.a.awrap(this.sendStatement(n));case 4:i.next=13;break;case 6:if(i.prev=6,i.t0=i.catch(0),!this.shouldHandlerErrors){i.next=12;break}ne(i.t0),i.next=13;break;case 12:throw i.t0;case 13:case"end":return i.stop()}}),null,this,[[0,6]])}}]),t}(z.a),re=new(function(){function e(){Object(i.a)(this,e),this.statements=void 0,this.statements=[]}return Object(s.a)(e,[{key:"push",value:function(e){this.statements.push(e)}},{key:"shift",value:function(){var e=this.statements;return this.statements=[],e}}]),e}()),ae=new(function(){function e(){Object(i.a)(this,e),this.settings=void 0,this.promises=void 0,this.batchSize=void 0}return Object(s.a)(e,[{key:"initialize",value:function(e){this.settings=e,this.promises=[],this.batchSize=5}},{key:"sendLrsStatement",value:function(e){if(this.isAllowedStatement(e))return re.push(e),this.sendStorageStatements(),Promise.all(this.promises)}},{key:"sendNpsStatement",value:function(e){this.doSend(U.nps.sendStatements.bind(U.nps),[e])}},{key:"isAllowedStatement",value:function(e){return this.settings.allowedVerbs.indexOf(e.verb.display["en-US"])>=0}},{key:"sendStorageStatements",value:function(){var e=re.shift();if(0!==e.length)for(;e.length;){var t=e.splice(0,this.batchSize);this.promises.push(this.doSend(U.lrs.sendStatements.bind(U.lrs),t))}}},{key:"doSend",value:function(e,t){return new Promise((function(n,i){e(t,(function(e){if(e){var t=e.find((function(e){return e.err}));t&&i(t.err)}n()}))}))}}]),e}()),oe=function(e){function t(){return Object(i.a)(this,t),Object(R.a)(this,Object(P.a)(t).call(this,{sendStatement:ae.sendLrsStatement.bind(ae),shouldHandlerErrors:!0}))}return Object(C.a)(t,e),Object(s.a)(t,[{key:"initialize",value:function(e){var t=e.isScoringOfContentPagesAllowed;this.handlers=[{event:H.b.COURSE_STARTED,instance:this.createHandler("courseStarted")},{event:H.b.COURSE_PROGRESSED,instance:this.createHandler("courseProgressed")},{event:H.b.SECTION_PROGRESSED,instance:this.createHandler("sectionProgressed")},{event:H.b.QUESTION_ANSWERED,instance:this.createHandler("questionAnswered")}],t&&this.handlers.push({event:H.b.INFORMATION_CONTENT_EXPERIENCED,instance:this.createHandler("informationContentExperienced")})}}]),t}(se),ce=function(e){function t(){return Object(i.a)(this,t),Object(R.a)(this,Object(P.a)(t).call(this,{sendStatement:ae.sendNpsStatement.bind(ae)}))}return Object(C.a)(t,e),Object(s.a)(t,[{key:"initialize",value:function(){this.handlers=[{event:H.b.COURSE_EVALUATED,instance:this.createHandler("courseEvaluated")}]}}]),t}(se),ue=function(){function e(){Object(i.a)(this,e),this.lrsEventHandler=void 0,this.npsEventHandler=void 0,this.settings=void 0,this.defaultLrsUrl=void 0,this.defaultNpsUrl=void 0,this.lrsEventHandler=new oe,this.npsEventHandler=new ce}return Object(s.a)(e,[{key:"subscribeLrs",value:function(){try{U.initializeLrs(this.settings.xApi,this.defaultLrsUrl)}catch(e){this.unsubscribeLrs(),ne(e)}this.lrsEventHandler.on()}},{key:"subscribeNps",value:function(){try{U.initializeNps(this.defaultNpsUrl)}catch(e){this.unsubscribeNps(),function(e){console.error("xApi error: [ ".concat(ie(e)," ]"))}(e)}this.npsEventHandler.on()}},{key:"unsubscribeLrs",value:function(){this.lrsEventHandler.off()}},{key:"unsubscribeNps",value:function(){this.npsEventHandler.off()}},{key:"unsubscribeAll",value:function(){this.unsubscribeLrs(),this.unsubscribeNps()}},{key:"initialize",value:function(e){var t=e.settings,n=e.defaultLrsUrl,i=e.defaultNpsUrl,s=e.course,r=e.actor;this.settings=t,this.defaultLrsUrl=n,this.defaultNpsUrl=i,this.lrsEventHandler.initialize(t),this.npsEventHandler.initialize(),U.initialize({course:s,actor:r}),ae.initialize(t.xApi)}}]),e}();t.default=new ue}}]);
//# sourceMappingURL=0.9f6ef157.chunk.js.map